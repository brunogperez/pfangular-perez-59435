import{a as Bt}from"./chunk-5YKRZHXE.js";import{a as Nt}from"./chunk-CHZWZK5J.js";import{a as At,b as Rt,c as $t,d as h,f as Ot,g as jt,i as Vt,j as Gt,k as Pt,l as kt,m as Ht,n as Lt}from"./chunk-KWYTEKE5.js";import{b as yt}from"./chunk-CK25IJLO.js";import{d as $}from"./chunk-A7RA4PBA.js";import{o as E,u as F}from"./chunk-HNE7D7Y7.js";import{A as Et,B as Ft,D as Tt,I as wt,a as N,e as A,f as R,g as lt,l as ct,m as dt,n as ft,o as ut,p as _t,q as gt,r as Ct,s as It,t as ht,u as Dt,v as vt,w as St,x as bt,y as xt,z as Mt}from"./chunk-IIQQG7MX.js";import{Ba as ot,Da as rt,Fa as at,Ga as w,Ia as y,Ja as mt,Ka as st,La as pt,_ as it,m as H,ta as T,ya as nt}from"./chunk-4SWAUFVP.js";import{Db as m,Ga as V,Ha as G,Ib as c,L as z,R as J,Rb as o,Sb as n,Tb as u,Ub as d,Vb as f,Xb as P,_b as C,ac as k,ca as K,e as q,fd as Y,gd as Z,id as M,kb as a,kc as Q,l as W,lb as l,lc as r,ld as tt,ma as v,mc as x,md as et,nc as I,wa as S,wc as _,xa as b,xc as g,yc as X}from"./chunk-PWY5XFB5.js";var L=q(yt());function ee(t,e){if(t&1&&(o(0,"mat-option",10),r(1),n()),t&2){let i=e.$implicit;c("value",i.id),a(),I(" ",i.name," ")}}var B=class t{constructor(e,i,s,p,D){this.matDialogRef=e;this.formBuilder=i;this.inscriptionService=s;this.store=p;this.data=D;this.courses$=this.store.select(jt),this.inscriptionForm=this.formBuilder.group({studentId:[{value:"",disabled:!0}],courseId:[null,rt.required]}),this.inscriptionForm.patchValue({studentId:D?.inscription?.id})}inscriptionForm;courses$;get studentIdControl(){return this.inscriptionForm.get("studentId")}get courseIdControl(){return this.inscriptionForm.get("courseId")}onSave(){if(this.inscriptionForm.invalid)this.inscriptionForm.markAllAsTouched();else{let e=this.inscriptionForm.getRawValue(),i=e.studentId,s=e.courseId;this.inscriptionService.isStudentEnrolled(i,s).subscribe(p=>{p?L.default.fire("Atenci\xF3n","El alumno ya est\xE1 inscripto en este curso.","info"):(this.store.dispatch(h.createInscription({studentId:i,courseId:s})),L.default.fire("Buen trabajo!","El alumno ha sido inscripto exitosamente.","success").then(()=>{this.matDialogRef.close()}))})}}static \u0275fac=function(i){return new(i||t)(l(ct),l(pt),l(Pt),l(E),l(dt))};static \u0275cmp=S({type:t,selectors:[["app-inscription-dialog"]],decls:19,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],[1,"col-12"],["matInput","","formControlName","studentId"],["formControlName","courseId"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-button","","mat-dialog-close",""],["mat-button","",3,"click"],[3,"value"]],template:function(i,s){i&1&&(o(0,"h1",0),r(1,"Formulario de inscripci\xF3n"),n(),o(2,"div",1)(3,"form",2)(4,"mat-form-field",3)(5,"mat-label"),r(6," ID del alumno "),n(),u(7,"input",4),n(),o(8,"mat-form-field",3)(9,"mat-label"),r(10," Categoria "),n(),o(11,"mat-select",5),m(12,ee,2,2,"mat-option",6),_(13,"async"),n()()(),o(14,"div",7)(15,"button",8),r(16,"Cancelar"),n(),o(17,"button",9),C("click",function(){return s.onSave()}),r(18,"Guardar"),n()()()),i&2&&(a(3),c("formGroup",s.inscriptionForm),a(9),c("ngForOf",g(13,2,s.courses$)))},dependencies:[Y,y,ot,at,w,mt,st,T,A,N,R,lt,it,ut,_t,Ct,gt,M]})};var Ut=q(yt());function ie(t,e){t&1&&(o(0,"th",18),r(1,"ID"),n())}function ne(t,e){if(t&1&&(o(0,"td",19),r(1),n()),t&2){let i=e.$implicit;a(),x(i.id)}}function oe(t,e){t&1&&(o(0,"th",18),r(1,"Name"),n())}function re(t,e){if(t&1&&(o(0,"td",19),r(1),_(2,"userFullName"),n()),t&2){let i=e.$implicit;a(),x(g(2,1,i))}}function ae(t,e){t&1&&(o(0,"th",18),r(1,"Email"),n())}function me(t,e){if(t&1&&(o(0,"td",19),r(1),n()),t&2){let i=e.$implicit;a(),x(i.email)}}function se(t,e){t&1&&(o(0,"th",18),r(1,"Edad"),n())}function pe(t,e){if(t&1&&(o(0,"td",19),r(1),_(2,"age"),n()),t&2){let i=e.$implicit;a(),I(" ",g(2,1,i.birthdate)," a\xF1os ")}}function le(t,e){t&1&&(o(0,"th",18),r(1,"Created Date"),n())}function ce(t,e){if(t&1&&(o(0,"td",19),r(1),_(2,"date"),n()),t&2){let i=e.$implicit;a(),I(" ",g(2,1,i.createdAt)," ")}}function de(t,e){t&1&&(o(0,"th",18),r(1,"Actions"),n())}function fe(t,e){if(t&1){let i=P();o(0,"td",19)(1,"button",20),C("click",function(){let p=V(i).$implicit,D=k(2);return G(D.openDialog(p))}),r(2," Inscribir a un curso "),n()()}}function ue(t,e){t&1&&u(0,"tr",21)}function _e(t,e){t&1&&u(0,"tr",22)}function ge(t,e){if(t&1&&(d(0),o(1,"div",6)(2,"table",7),d(3,8),m(4,ie,2,0,"th",9)(5,ne,2,1,"td",10),f(),d(6,11),m(7,oe,2,0,"th",9)(8,re,3,3,"td",10),f(),d(9,12),m(10,ae,2,0,"th",9)(11,me,2,1,"td",10),f(),d(12,13),m(13,se,2,0,"th",9)(14,pe,3,3,"td",10),f(),d(15,14),m(16,le,2,0,"th",9)(17,ce,3,3,"td",10),f(),d(18,15),m(19,de,2,0,"th",9)(20,fe,3,0,"td",10),f(),m(21,ue,1,0,"tr",16)(22,_e,1,0,"tr",17),n()(),f()),t&2){let i=k();a(2),c("dataSource",i.students$),a(19),c("matHeaderRowDef",i.displayedColumns),a(),c("matRowDefColumns",i.displayedColumns)}}function Ce(t,e){t&1&&(u(0,"mat-progress-bar",23),o(1,"p",24),r(2,"CARGANDO..."),n())}var O=class t{constructor(e,i){this.matDialog=e;this.store=i;this.students$=this.store.select($t),this.inscriptions$=this.store.select(Gt)}displayedColumns=["id","name","email","birthdate","createdAt","actions"];searchTerm$=new W;students$;inscriptions$;ngOnInit(){this.store.dispatch(h.loadInscriptions()),this.searchTerm$.pipe(K(""),z(400),J()).subscribe(e=>{this.store.dispatch(At.searchStudents({term:e}))})}search(e){let i=e.currentTarget;this.searchTerm$.next(i.value)}openDialog(e){this.matDialog.open(B,{data:{inscription:e}})}onDelete(e){Ut.default.fire({title:"\xBFEst\xE1s seguro?",text:"No podr\xE1s revertir esta acci\xF3n",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.store.dispatch(h.deleteInscription({id:e}))})}static \u0275fac=function(i){return new(i||t)(l(ft),l(E))};static \u0275cmp=S({type:t,selectors:[["app-inscriptions"]],decls:11,vars:4,consts:[["loading",""],[1,"text-center"],[1,"example-form"],[1,"col-4"],["matInput","","type","search","name","","id","",3,"input"],[4,"ngIf","ngIfElse"],[1,"m-5","p-2","bg-table","rounded-4"],["mat-table","",1,"bg-table",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","email"],["matColumnDef","birthdate"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-flat-button","",1,"m-1",3,"click"],["mat-header-row",""],["mat-row",""],["mode","indeterminate"],[1,"text-center","my-5"]],template:function(i,s){if(i&1){let p=P();o(0,"div",1)(1,"form",2)(2,"mat-form-field",3)(3,"mat-label"),r(4,"Buscar alumno"),n(),o(5,"input",4),C("input",function(Wt){return V(p),G(s.search(Wt))}),n()()()(),u(6,"mat-divider"),m(7,ge,23,3,"ng-container",5),_(8,"async"),m(9,Ce,3,0,"ng-template",null,0,X)}if(i&2){let p=Q(10);a(7),c("ngIf",g(8,2,s.students$))("ngIfElse",p)}},dependencies:[Z,y,w,T,A,N,R,It,Dt,xt,vt,ht,Mt,St,bt,Et,Ft,nt,Tt,M,tt,Nt,Bt],styles:[".bg-table[_ngcontent-%COMP%]{background-color:#2e3b38}"]})};var Ie=[{path:"",component:O}],j=class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=b({type:t});static \u0275inj=v({imports:[H.forChild(Ie),H]})};var qt=class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=b({type:t});static \u0275inj=v({imports:[et,j,wt,F.forFeature(Vt),$.forFeature([Ht]),F.forFeature(Rt),$.forFeature([kt]),F.forFeature(Ot),$.forFeature([Lt])]})};export{qt as InscriptionsModule};
